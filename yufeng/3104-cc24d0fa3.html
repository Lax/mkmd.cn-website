<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />

	<title>基于LLVM的高性能Erlang(Hipe)尝鲜 | 系统技术非业余研究</title>
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0 - all posts" href="http://blog.yufeng.info/feed" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0 - all comments" href="http://blog.yufeng.info/comments/feed" />
	<link rel="pingback" href="http://blog.yufeng.info/xmlrpc.php" />

	<!-- style START -->
	<!-- default style -->
	<style type="text/css" media="screen">@import url( http://blog.yufeng.info/wp-content/themes/inove/style.css );</style>
	<!-- for translations -->
		<!--[if IE]>
		<link rel="stylesheet" href="http://blog.yufeng.info/wp-content/themes/inove/ie.css" type="text/css" media="screen" />
	<![endif]-->
	<!-- style END -->

	<!-- script START -->
	<script type="text/javascript" src="http://blog.yufeng.info/wp-content/themes/inove/js/base.js"></script>
	<script type="text/javascript" src="http://blog.yufeng.info/wp-content/themes/inove/js/menu.js"></script>
	<!-- script END -->

	<link rel="alternate" type="application/rss+xml" title="系统技术非业余研究 &raquo; 基于LLVM的高性能Erlang(Hipe)尝鲜 Comments Feed" href="http://blog.yufeng.info/archives/3104/feed" />
<link rel='stylesheet' id='yarppWidgetCss-css'  href='http://blog.yufeng.info/wp-content/plugins/yet-another-related-posts-plugin/style/widget.css?ver=4.0' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-subscriptions-css'  href='http://blog.yufeng.info/wp-content/plugins/jetpack/modules/subscriptions/subscriptions.css?ver=4.0' type='text/css' media='all' />
<link rel='stylesheet' id='wp-syntax-css-css'  href='http://blog.yufeng.info/wp-content/themes/inove/wp-syntax.css?ver=1.0' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-widgets-css'  href='http://blog.yufeng.info/wp-content/plugins/jetpack/modules/widgets/widgets.css?ver=20121003' type='text/css' media='all' />
<!-- This site uses the Yoast Google Analytics plugin v5.0.7 - Universal disabled - https://yoast.com/wordpress/plugins/google-analytics/ -->
<script type="text/javascript">

	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-6788139-3']);
	_gaq.push(['_gat._forceSSL']);
	_gaq.push(['_trackPageview']);

	(function () {
		var ga = document.createElement('script');
		ga.type = 'text/javascript';
		ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0];
		s.parentNode.insertBefore(ga, s);
	})();

</script>
<!-- / Yoast Google Analytics -->
<script type='text/javascript' src='http://blog.yufeng.info/wp-includes/js/jquery/jquery.js?ver=1.11.1'></script>
<script type='text/javascript' src='http://blog.yufeng.info/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://blog.yufeng.info/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://blog.yufeng.info/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Erlang 新数据类型Map的定位和性能' href='http://blog.yufeng.info/archives/3098' />
<link rel='next' title='Erlang内存分配器之mbcs_pool' href='http://blog.yufeng.info/archives/3118' />
<meta name="generator" content="WordPress 4.0" />
<link rel='shortlink' href='http://wp.me/p1sdcD-O4' />

<script type='text/javascript'>
var g_hanaFlash = false;
try {
  var fo = new ActiveXObject('ShockwaveFlash.ShockwaveFlash');
  if(fo) g_hanaFlash = true;
}catch(e){
  if(navigator.mimeTypes ['application/x-shockwave-flash'] != undefined) g_hanaFlash = true;
}
function hanaTrackEvents(arg1,arg2,arg3,arg4) { if ( typeof( pageTracker ) !=='undefined') { pageTracker._trackEvent(arg1, arg2, arg3, arg4);} else if ( typeof(_gaq) !=='undefined'){  _gaq.push(['_trackEvent', arg1, arg2, arg3, arg4]);}}
function hana_check_mobile_device(){ if(navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPod/i) || navigator.userAgent.match(/iPad/i)  || navigator.userAgent.match(/Android/i)) { return true; }else return false; }
</script>
<style type="text/css">
.sfs-subscriber-count { width: 88px; overflow: hidden; height: 26px; color: #424242; font: 9px Verdana, Geneva, sans-serif; letter-spacing: 1px; }
.sfs-count { width: 86px; height: 17px; line-height: 17px; margin: 0 auto; background: #ccc; border: 1px solid #909090; border-top-color: #fff; border-left-color: #fff; }
.sfs-count span { display: inline-block; height: 11px; line-height: 12px; margin: 2px 1px 2px 2px; padding: 0 2px 0 3px; background: #e4e4e4; border: 1px solid #a2a2a2; border-bottom-color: #fff; border-right-color: #fff; }
.sfs-stats { font-size: 6px; line-height: 6px; margin: 1px 0 0 1px; word-spacing: 2px; text-align: center; text-transform: uppercase; }
</style>
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>

<!-- All in One SEO Pack 2.2.3.1 by Michael Torbert of Semper Fi Web Design[326,375] -->
<link rel="author" href="https://plus.google.com/113696493914077990187" />
<meta name="description"  content="即将发布的R17A版本引入很重要的一个针对性能提升的特性：&quot;Support the LLVM backend in HiPE&quot;，具体改变参见这里." />

<meta name="keywords"  content="hipe,llvm,erlang探索,体系结构,源码分析" />

<link rel="canonical" href="http://blog.yufeng.info/archives/3104" />
		<script type="text/javascript">
		  var _gaq = _gaq || [];
		  _gaq.push(['_setAccount', 'UA-6788139-3']);
		  _gaq.push(['_setAllowLinker', true]);
		  _gaq.push(['_trackPageview']);
		  (function() {
		    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		  })();
		</script>
		<script type="text/javascript">
		function recordOutboundLink(link, category, action) {
					_gat._getTrackerByName()._trackEvent(category, action);
					if ( link.target == '_blank' ) return true;
			setTimeout('document.location = "' + link.href + '"', 100);
			return false;
		}
			/* use regular Javascript for this */
			function getAttr(ele, attr) {
				var result = (ele.getAttribute && ele.getAttribute(attr)) || null;
				if( !result ) {
					var attrs = ele.attributes;
					var length = attrs.length;
					for(var i = 0; i < length; i++)
					if(attr[i].nodeName === attr) result = attr[i].nodeValue;
				}
				return result;
			}
			function aiosp_addLoadEvent(func) {
			  var oldonload = window.onload;
			  if (typeof window.onload != 'function') {
			    window.onload = func;
			  } else {
			    window.onload = function() {
			      if (oldonload) {
			        oldonload();
			      }
			      func();
			    }
			  }
			}
			
			function aiosp_addEvent(element, evnt, funct){
			  if (element.attachEvent)
			   return element.attachEvent('on'+evnt, funct);
			  else
			   return element.addEventListener(evnt, funct, false);
			}

			aiosp_addLoadEvent(function () {
				var links = document.getElementsByTagName('a');
				for (var x=0; x < links.length; x++) {
					if (typeof links[x] == 'undefined') continue;
					aiosp_addEvent( links[x], 'onclick', function () {
						var mydomain = new RegExp(document.domain, 'i');
						href = getAttr(this, 'href');
						if (href && href.toLowerCase().indexOf('http') === 0 && !mydomain.test(href)) {
							recordOutboundLink(this, 'Outbound Links', href);
						}
					});
				}
			});
		</script>
<!-- /all in one seo pack -->

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="基于LLVM的高性能Erlang(Hipe)尝鲜" />
<meta property="og:url" content="http://blog.yufeng.info/archives/3104" />
<meta property="og:description" content="即将发布的R17A版本引入很重要的一个针对性能提升的特性：&quot;Support the LLVM backend in HiPE&quot;，具体改变参见这里. 我们知道Erlang是一门领域语言，第一天就是为电信工业高可用，集群和热更新环境而设计的，语言的性能一开始不是重点。直到R12版本才加入SMP多处理器，充分适应多核化的硬件发展趋势，从此向着高性能大步迈进。 Erlang的虚拟机是register..." />
<meta property="article:published_time" content="2014-03-25T13:22:58+00:00" />
<meta property="article:modified_time" content="2014-03-25T15:59:55+00:00" />
<meta property="article:author" content="http://blog.yufeng.info/archives/author/admin" />
<meta property="og:site_name" content="系统技术非业余研究" />
<meta property="og:image" content="http://blog.yufeng.info/wp-content/uploads/2014/03/hipe_erllvm.png" />
<meta property="og:image" content="http://blog.yufeng.info/wp-content/uploads/2014/03/beam_erllvm.png" />
<meta property="og:image" content="http://blog.yufeng.info/wp-content/uploads/2014/03/llvm_pipeline.png" />
<meta property="og:image" content="http://blog.yufeng.info/wp-content/uploads/2014/03/722x227-hipe_llvm_arch.png" />
<meta name="twitter:site" content="@jetpack" />
<meta name="twitter:image" content="http://blog.yufeng.info/wp-content/uploads/2014/03/722x227-hipe_llvm_arch.png?w=240" />
<meta name="twitter:card" content="summary" />
<style type="text/css" id="syntaxhighlighteranchor"></style>
<!-- wp thread comment 1.4.9.4.002 -->
<style type="text/css" media="screen">

.editComment, .editableComment, .textComment{
	display: inline;
}
.comment-childs{
	border: 1px solid #999;
	margin: 5px 2px 2px 4px;
	padding: 4px 2px 2px 4px;
	background-color: white;
}
.chalt{
	background-color: #E2E2E2;
}
#newcomment{
	border:1px dashed #777;width:90%;
}
#newcommentsubmit{
	color:red;
}
.adminreplycomment{
	border:1px dashed #777;
	width:99%;
	margin:4px;
	padding:4px;
}
.mvccls{
	color: #999;
}
			
</style>
</head>


<body>                                                                                                                                                                                                                                                                                                                                                                                                                <!-- wrap START -->
<div id="wrap">

<!-- container START -->
<div id="container"  >

<!-- header START -->
<div id="header">

	<!-- banner START -->
			<div class="banner">
			捐赠：<a href="https://me.alipay.com/mryufeng">喜欢就请我喝一杯</a> 		</div>
		<!-- banner END -->

	<div id="caption">
		<h1 id="title"><a href="http://blog.yufeng.info/">系统技术非业余研究</a></h1>
		<div id="tagline">系统技术深度探索和应用</div>
	</div>

	<div class="fixed"></div>
</div>
<!-- header END -->

<!-- navigation START -->
<div id="navigation">
	<!-- menus START -->
	<ul id="menus">
		<li class="page_item"><a class="home" title="Home" href="http://blog.yufeng.info/">Home</a></li>
		<li class="page_item page-item-591"><a href="http://blog.yufeng.info/job">推荐工作机会</a></li>
<li class="page_item page-item-122"><a href="http://blog.yufeng.info/ppt">资料下载</a></li>
<li class="page_item page-item-65"><a href="http://blog.yufeng.info/%e7%95%99%e8%a8%80%e6%9d%bf">留言板</a></li>
<li class="page_item page-item-2"><a href="http://blog.yufeng.info/about">关于我</a></li>
		<li><a class="lastmenu" href="javascript:void(0);"></a></li>
	</ul>
	<!-- menus END -->

	<!-- searchbox START -->
	<div id="searchbox">
					<form action="http://www.google.com/cse" method="get">
				<div class="content">
					<input type="text" class="textfield" name="q" size="24" />
					<input type="submit" class="button" name="sa" value="" />
					<input type="hidden" name="cx" value="011994216034381653247:b54vq7hrjse" />
					<input type="hidden" name="ie" value="UTF-8" />
				</div>
			</form>
			</div>
<script type="text/javascript">
//<![CDATA[
	var searchbox = MGJS.$("searchbox");
	var searchtxt = MGJS.getElementsByClassName("textfield", "input", searchbox)[0];
	var searchbtn = MGJS.getElementsByClassName("button", "input", searchbox)[0];
	var tiptext = "Type text to search here...";
	if(searchtxt.value == "" || searchtxt.value == tiptext) {
		searchtxt.className += " searchtip";
		searchtxt.value = tiptext;
	}
	searchtxt.onfocus = function(e) {
		if(searchtxt.value == tiptext) {
			searchtxt.value = "";
			searchtxt.className = searchtxt.className.replace(" searchtip", "");
		}
	}
	searchtxt.onblur = function(e) {
		if(searchtxt.value == "") {
			searchtxt.className += " searchtip";
			searchtxt.value = tiptext;
		}
	}
	searchbtn.onclick = function(e) {
		if(searchtxt.value == "" || searchtxt.value == tiptext) {
			return false;
		}
	}
//]]>
</script>
	<!-- searchbox END -->

	<div class="fixed"></div>
</div>
<!-- navigation END -->

<!-- content START -->
<div id="content">

	<!-- main START -->
	<div id="main">


	<div id="postpath">
		<a title="Go to homepage" href="http://blog.yufeng.info/">Home</a>
		 &gt; <a href="http://blog.yufeng.info/archives/category/erlang" rel="category tag">Erlang探索</a>, <a href="http://blog.yufeng.info/archives/category/%e4%bd%93%e7%b3%bb%e7%bb%93%e6%9e%84" rel="category tag">体系结构</a>, <a href="http://blog.yufeng.info/archives/category/%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90" rel="category tag">源码分析</a>		 &gt; 基于LLVM的高性能Erlang(Hipe)尝鲜	</div>

	<div class="post" id="post-3104">
		<h2>基于LLVM的高性能Erlang(Hipe)尝鲜</h2>
		<div class="info">
			<span class="date">March 25th, 2014</span>
			<span class="author"><a href="http://blog.yufeng.info/archives/author/admin" title="Posts by Yu Feng" rel="author">Yu Feng</a></span>										<span class="addcomment"><a href="#respond">Leave a comment</a></span>
				<span class="comments"><a href="#comments">Go to comments</a></span>
						<div class="fixed"></div>
		</div>
		<div class="content">
			<div style="margin-top: 15px; font-style: italic">
<p><strong>原创文章，转载请注明：</strong> 转载自<a href="http://blog.yufeng.info/" onclick="_gaq.push(['_trackEvent', 'outbound-article-int', 'http://blog.yufeng.info/', '系统技术非业余研究']);" >系统技术非业余研究</a></p>
<p><strong>本文链接地址:</strong> <a href="http://blog.yufeng.info/archives/3104" onclick="_gaq.push(['_trackEvent', 'outbound-article-int', 'http://blog.yufeng.info/archives/3104', '基于LLVM的高性能Erlang(Hipe)尝鲜']);" >基于LLVM的高性能Erlang(Hipe)尝鲜</a></p>
</div>
<p>即将发布的R17A版本引入很重要的一个针对性能提升的特性：&#8221;Support the LLVM backend in HiPE&#8221;，具体改变参见<a href="https://github.com/erlang/otp/commit/9d46875b53ffb21bc55aec4a2c76472133ea5d1c" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/erlang/otp/commit/9d46875b53ffb21bc55aec4a2c76472133ea5d1c', '这里']);" >这里</a>. 我们知道Erlang是一门领域语言，第一天就是为电信工业高可用，集群和热更新环境而设计的，语言的性能一开始不是重点。直到R12版本才加入SMP多处理器，充分适应多核化的硬件发展趋势，从此向着高性能大步迈进。</p>
<p>Erlang的虚拟机是register based的，性能上和python类似，和c语言大概有7倍的差距。虽然大部分的集群和网络服务器，性能瓶颈在IO上面，而且这块erts(erlang运行期系统）做的非常的强大，但是一旦涉及到大量的计算，就有点麻烦了，因为它缺乏类似java jit那样强大的支持，让语言足够的快。解决方案是自己写nif、driver或者bif,但是会破坏稳定性。</p>
<p>它很早有自己的hipe, 主要是Uppsala University大学的Kostis Sagonas带领学生做的, 97年开始做的，性能的提升虽然不少，但是在架构上有些缺点，而且和otp团队是二个不同的团队，在稳定性上无法达到产品质量。为了进一步解决这个问题，他带着Christos Stavrakakis和Yiannis Tsiouris，重新实现了基于LLVM后端的Hipe，也就是erllvm，官方网站在<a href="http://erllvm.softlab.ntua.gr/ " onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://erllvm.softlab.ntua.gr/ ', '这里']);" >这里</a>. </p>
<p>官方描述如下：</p>
<blockquote><p>ErLLVM is a project aiming at providing multiple back ends for the High Performance Erlang (HiPE) with the use of the LLVM infastructure.
</p></blockquote>
<p>这次R17发布就是把ErLLVM融入到erlang主干版本去。那么ErLLVM的技术改进点在哪里？看下面的图就明白了。</p>
<p><a href="http://blog.yufeng.info/wp-content/uploads/2014/03/722x227-hipe_llvm_arch.png" onclick="_gaq.push(['_trackEvent', 'outbound-article-int', 'http://blog.yufeng.info/wp-content/uploads/2014/03/722x227-hipe_llvm_arch.png', '']);" ><img src="http://blog.yufeng.info/wp-content/uploads/2014/03/722x227-hipe_llvm_arch.png" alt="722x227-hipe_llvm_arch" width="722" height="227" class="alignnone size-full wp-image-3106" /></a></p>
<p>最关键的一点就是之前的hipe自己从RTL生成硬件代码，而ErlLvm把这个事情交给了llvm专业去生成，它只做RTL->llvm层的薄薄的翻译，这样稳定性的问题就offload交给了llvm，而llvm的稳定性是经过社区规模考验的。</p>
<p><a href="http://blog.yufeng.info/wp-content/uploads/2014/03/llvm_pipeline.png" onclick="_gaq.push(['_trackEvent', 'outbound-article-int', 'http://blog.yufeng.info/wp-content/uploads/2014/03/llvm_pipeline.png', '']);" ><img src="http://blog.yufeng.info/wp-content/uploads/2014/03/llvm_pipeline.png" alt="llvm_pipeline" width="411" height="699" class="alignnone size-full wp-image-3107" /></a></p>
<p>这样就很好的解决了稳定性和性能的问题。<span id="more-3104"></span></p>
<p>作者在erlang factory上有个<a href="http://www.erlang-factory.com/upload/presentations/519/erllvm.pdf" onclick="_gaq.push(['_trackEvent','download','http://www.erlang-factory.com/upload/presentations/519/erllvm.pdf']);" >演讲</a>， 我们摘抄<a href="http://erllvm.softlab.ntua.gr/documentation/installation/" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://erllvm.softlab.ntua.gr/documentation/installation/', '']);" ></a>下性能数字：</p>
<p>和原生的beam相比：<br />
<a href="http://blog.yufeng.info/wp-content/uploads/2014/03/beam_erllvm.png" onclick="_gaq.push(['_trackEvent', 'outbound-article-int', 'http://blog.yufeng.info/wp-content/uploads/2014/03/beam_erllvm.png', '']);" ><img src="http://blog.yufeng.info/wp-content/uploads/2014/03/beam_erllvm.png" alt="beam_erllvm" width="939" height="469" class="alignnone size-full wp-image-3109" /></a></p>
<p>和最初的hipe相比：<br />
<a href="http://blog.yufeng.info/wp-content/uploads/2014/03/hipe_erllvm.png" onclick="_gaq.push(['_trackEvent', 'outbound-article-int', 'http://blog.yufeng.info/wp-content/uploads/2014/03/hipe_erllvm.png', '']);" ><img src="http://blog.yufeng.info/wp-content/uploads/2014/03/hipe_erllvm.png" alt="hipe_erllvm" width="941" height="529" class="alignnone size-full wp-image-3110" /></a></p>
<p>我们可以看到和原来的hipe性能相当，但是稳定性提升不少。接下来我们来体验下，安装指南在这里。<br />
首先需要安装llvm, 下载页面在<a href="http://llvm.org/releases/download.html" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://llvm.org/releases/download.html', '这里']);" >这里</a>，只需要安装3.4版本以上就好。</p>
<blockquote><p>
NOTE: A custom LLVM version is not needed anymore in order to install and use the LLVM backend for HiPE. You can safely ignore everything below by making sure that you have LLVM 3.4 (or newer) installed in your system.</p></blockquote>
<p>我的系统是RHEL6U2, 安装过程如下：</p>
<pre class="brush: bash; title: ; notranslate" title="">
$ uname -r
2.6.32-220.23.1.tb704.el6.x86_64
$ wget http://llvm.org/releases/3.4/llvm-3.4.src.tar.gz
$ tar xzvf llvm-3.4.src.tar.gz 
$ cd llvm-3.4
$ mkdir build &amp;&amp; cd build
$ ../configure &amp;&amp; make -j 16
$ sudo make install
</pre>
<p>如果不出意外，llvm就安装好了，如何确认呢？<br />
<code>$ which llc<br />
/usr/local/bin/llc<br />
</code><br />
能顺利看到llc就好了, 说明安装成功，接下来安装erlang. </p>
<p>erlang我们很熟悉了，我就不啰嗦了，用kerl快速搞起，为了看到效果，我们把lib/hipe/llvm/hipe_llvm_main.erl里面的io:format打开方便调试。</p>
<pre class="brush: bash; title: ; notranslate" title="">
$ kerl build git git://github.com/erlang/otp master r17alph
$ kerl install r17alph r17alph
$ r17alph/bin/erl
Erlang/OTP 17 [RELEASE CANDIDATE 2] [erts-6.0] 1 [64-bit] [smp:16:16] [async-threads:10] [hipe] [kernel-poll:false]

Eshell V6.0  (abort with ^G)
1&gt; 
</pre>
<p>看版本号就知道我们安装完毕了，现在来把玩下：</p>
<pre class="brush: bash; title: ; notranslate" title="">
$ cat &gt; test.erl
-module(test).
-export([hello/1]).
hello(Name) -&gt;
  io:format(&quot;Hello ~w!~n&quot;, [Name]).
CTRL+D

$ r17alph/bin/erl
Erlang/OTP 17 [RELEASE CANDIDATE 2] [erts-6.0] 1 [64-bit] [smp:16:16] [async-threads:10] [hipe] [kernel-poll:false]

Eshell V6.0  (abort with ^G)
1&gt; c(test).
{ok,test}
2&gt; hipe:c(test, [to_llvm]).
OPT: opt -O3 -mem2reg -strip /dev/shm/llvm_319827/module_info_0.ll -o /dev/shm/llvm_319827/module_info_0.bc
OPT: opt -O3 -mem2reg -strip /dev/shm/llvm_107590586/module_info_1.ll -o /dev/shm/llvm_107590586/module_info_1.bc
OPT: opt -O3 -mem2reg -strip /dev/shm/llvm_128365190/hello_1.ll -o /dev/shm/llvm_128365190/hello_1.bc
LLC: llc -O3 -code-model=medium -stack-alignment=8 -tailcallopt -filetype=asm /dev/shm/llvm_319827/module_info_0.bc
LLC: llc -O3 -code-model=medium -stack-alignment=8 -tailcallopt -filetype=asm /dev/shm/llvm_107590586/module_info_1.bc
LLC: llc -O3 -code-model=medium -stack-alignment=8 -tailcallopt -filetype=asm /dev/shm/llvm_128365190/hello_1.bc
gcc: gcc -c /dev/shm/llvm_319827/module_info_0.s -o /dev/shm/llvm_319827/module_info_0.o
gcc: gcc -c /dev/shm/llvm_107590586/module_info_1.s -o /dev/shm/llvm_107590586/module_info_1.o
gcc: gcc -c /dev/shm/llvm_128365190/hello_1.s -o /dev/shm/llvm_128365190/hello_1.o
{ok,test}
3&gt;  test:hello(world).
Hello world!
ok
4&gt; test:module_info().
[{exports,[{hello,1},{module_info,0},{module_info,1}]},
 {imports,[]},
 {attributes,[{vsn,[66993814452650317180827424605876502141]}]},
 {compile,[{options,[]},
           {version,&quot;5.0&quot;},
           {time,{2014,3,25,12,24,14}},
           {source,&quot;/home/chuba/test.erl&quot;}]}]
5&gt; 
BREAK: (a)bort (c)ontinue (p)roc info (i)nfo (l)oaded
       (v)ersion (k)ill (D)b-tables (d)istribution
</pre>
<p>上面的例子我们演示了，先编译成普通的beam文件再通过hipe转成jit的例子，程序运行正常。同时我们也很清楚的看到llvm的工具链如何在后台生成代码。</p>
<p>接着我们演示下直接编程成hipe格式的:</p>
<pre class="brush: bash; title: ; notranslate" title="">
$ r17alph/bin/erlc +native +&quot;{hipe, [to_llvm]}&quot;  test.erl 
OPT: opt -O3 -mem2reg -strip /dev/shm/llvm_117655405/module_info_1.ll -o /dev/shm/llvm_117655405/module_info_1.bc
OPT: opt -O3 -mem2reg -strip /dev/shm/llvm_37062758/module_info_0.ll -o /dev/shm/llvm_37062758/module_info_0.bc
OPT: opt -O3 -mem2reg -strip /dev/shm/llvm_87781561/hello_1.ll -o /dev/shm/llvm_87781561/hello_1.bc
LLC: llc -O3 -code-model=medium -stack-alignment=8 -tailcallopt -filetype=asm /dev/shm/llvm_117655405/module_info_1.bc
LLC: llc -O3 -code-model=medium -stack-alignment=8 -tailcallopt -filetype=asm /dev/shm/llvm_37062758/module_info_0.bc
LLC: llc -O3 -code-model=medium -stack-alignment=8 -tailcallopt -filetype=asm /dev/shm/llvm_87781561/hello_1.bc
gcc: gcc -c /dev/shm/llvm_37062758/module_info_0.s -o /dev/shm/llvm_37062758/module_info_0.o
gcc: gcc -c /dev/shm/llvm_117655405/module_info_1.s -o /dev/shm/llvm_117655405/module_info_1.o
gcc: gcc -c /dev/shm/llvm_87781561/hello_1.s -o /dev/shm/llvm_87781561/hello_1.o

$ r17alph/bin/erl 
Erlang/OTP 17 [RELEASE CANDIDATE 2] [erts-6.0] 1 [64-bit] [smp:16:16] [async-threads:10] [hipe] [kernel-poll:false]

Eshell V6.0  (abort with ^G)
1&gt; test:module_info().
[{exports,[{hello,1},{module_info,0},{module_info,1}]},
 {imports,[]},
 {attributes,[{vsn,[66993814452650317180827424605876502141]}]},
 {compile,[{options,[{outdir,&quot;/home/chuba&quot;},
                     {hipe,[to_llvm]},
                     native]},
           {version,&quot;5.0&quot;},
           {time,{2014,3,25,12,25,2}},
           {source,&quot;/home/chuba/test.erl&quot;}]}]
2&gt; 
BREAK: (a)bort (c)ontinue (p)roc info (i)nfo (l)oaded
       (v)ersion (k)ill (D)b-tables (d)istribution

$ r17alph/bin/erl -noshell -s test hello world  -s erlang halt
Hello [world]!
</pre>
<p>有兴趣的同学可以深入测试下性能和稳定性的提升，分享出来。</p>
<p>小结： ErLLVM同等性能，稳定性更好, 官方说法是可以在产品中使用。<br />
祝玩得开心！</p>
<div style="margin-top: 0; margin-bottom: 15px; color: #888888; font-size: 80%; font-style: italic">
<p>Post Footer automatically generated by <a href="http://easwy.com/blog/wordpress/wp-posturl/" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://easwy.com/blog/wordpress/wp-posturl/', 'wp-posturl plugin']);"   style="color: #8888FF; text-decoration: underline;">wp-posturl plugin</a> for wordpress.</p>
</div>
<div class='yarpp-related'>
<p>Related posts:</p><ol>
<li><a href="http://blog.yufeng.info/archives/1425" rel="bookmark" title="The Erlang/OTP Roadmap(Erlang Factory London 2011)">The Erlang/OTP Roadmap(Erlang Factory London 2011) </a></li>
</ol>
</div>
			<div class="fixed"></div>
		</div>
		<div class="under">
			<span class="categories">Categories: </span><span><a href="http://blog.yufeng.info/archives/category/erlang" rel="category tag">Erlang探索</a>, <a href="http://blog.yufeng.info/archives/category/%e4%bd%93%e7%b3%bb%e7%bb%93%e6%9e%84" rel="category tag">体系结构</a>, <a href="http://blog.yufeng.info/archives/category/%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90" rel="category tag">源码分析</a></span>			<span class="tags">Tags: </span><span><a href="http://blog.yufeng.info/archives/tag/hipe" rel="tag">hipe</a>, <a href="http://blog.yufeng.info/archives/tag/llvm" rel="tag">llvm</a></span>		</div>
	</div>

	<!-- related posts START -->
		<!-- related posts END -->

	<script type="text/javascript" src="http://blog.yufeng.info/wp-content/themes/inove/js/comment.js"></script>



<div id="comments">

<div id="cmtswitcher">
			<a id="commenttab" class="curtab" href="javascript:void(0);" onclick="MGJS.switchTab('thecomments,commentnavi', 'thetrackbacks', 'commenttab', 'curtab', 'trackbacktab', 'tab');">Comments (4)</a>
		<a id="trackbacktab" class="tab" href="javascript:void(0);" onclick="MGJS.switchTab('thetrackbacks', 'thecomments,commentnavi', 'trackbacktab', 'curtab', 'commenttab', 'tab');">Trackbacks (0)</a>
				<span class="addcomment"><a href="#respond">Leave a comment</a></span>
				<span class="addtrackback"><a href="http://blog.yufeng.info/archives/3104/trackback">Trackback</a></span>
		<div class="fixed"></div>
</div>

<div id="commentlist">
	<!-- comments START -->
	<ol id="thecomments">
		<li class="comment regularcomment" id="comment-24519">
		<div class="author">
			<div class="pic">
				<img alt='' src='http://0.gravatar.com/avatar/42b722ed664104b1414eb89bf683ea76?s=32&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D32&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />			</div>
			<div class="name">
									<span id="commentauthor-24519">
				
				Herry
									</span>
							</div>
		</div>

		<div class="info">
			<div class="date">
				March 28th, 2014 at 11:59					 | <a href="#comment-24519">#1</a>
			</div>
			<div class="act">
				<a href="javascript:void(0);" onclick="MGJS_CMT.reply('commentauthor-24519', 'comment-24519', 'comment');">Reply</a> | 
				<a href="javascript:void(0);" onclick="MGJS_CMT.quote('commentauthor-24519', 'comment-24519', 'commentbody-24519', 'comment');">Quote</a>
							</div>
			<div class="fixed"></div>
			<div class="content">
				
				<div id="commentbody-24519">
					<p>Hi，余大<br />
我运行hipe:c(test, [to_llvm]).报错<br />
 Warning: [hipe:1515]: Unknown options: [to_llvm].<br />
google的半天也没找到靠谱的解决办法</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,24519,1,'Herry');">Reply</a>]</p><div class="comment-childs chalt" id="comment-24523"><img alt='' src='http://0.gravatar.com/avatar/2f3b92251d56989e1fdbe07eb6299160?s=32&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D32&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' /><p><cite><a href='http://yufeng.info' rel='external nofollow' class='url'>Yu Feng</a></cite> Reply:<br /><small class="commentmetadata">March 28th, 2014 at 3:26 pm</small></p><p>最近的R17才有，也就是说最新的github上的master分支，还没有发布呢</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,24523,2,'Yu Feng');">Reply</a>]</p><div class="comment-childs" id="comment-24524"><img alt='' src='http://0.gravatar.com/avatar/42b722ed664104b1414eb89bf683ea76?s=32&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D32&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' /><p><cite>Herry</cite> Reply:<br /><small class="commentmetadata">March 28th, 2014 at 5:49 pm</small></p><p>多谢余大</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,24524,3,'Herry');">Reply</a>]</p></div></div>				</div>
			</div>
		</div>
		<div class="fixed"></div>

</li><!-- #comment-## -->
	<li class="comment regularcomment" id="comment-24537">
		<div class="author">
			<div class="pic">
				<img alt='' src='http://0.gravatar.com/avatar/c6ae6af885e39b67872494023dc970e8?s=32&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D32&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />			</div>
			<div class="name">
									<span id="commentauthor-24537">
				
				manlin
									</span>
							</div>
		</div>

		<div class="info">
			<div class="date">
				March 29th, 2014 at 11:49					 | <a href="#comment-24537">#2</a>
			</div>
			<div class="act">
				<a href="javascript:void(0);" onclick="MGJS_CMT.reply('commentauthor-24537', 'comment-24537', 'comment');">Reply</a> | 
				<a href="javascript:void(0);" onclick="MGJS_CMT.quote('commentauthor-24537', 'comment-24537', 'commentbody-24537', 'comment');">Quote</a>
							</div>
			<div class="fixed"></div>
			<div class="content">
				
				<div id="commentbody-24537">
					<p>热更新还像以前一样方便么</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,24537,1,'manlin');">Reply</a>]</p><div class="comment-childs chalt" id="comment-24538"><img alt='' src='http://0.gravatar.com/avatar/2f3b92251d56989e1fdbe07eb6299160?s=32&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D32&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' /><p><cite><a href='http://yufeng.info' rel='external nofollow' class='url'>Yu Feng</a></cite> Reply:<br /><small class="commentmetadata">March 29th, 2014 at 12:20 pm</small></p><p>没变</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,24538,2,'Yu Feng');">Reply</a>]</p></div>				</div>
			</div>
		</div>
		<div class="fixed"></div>

</li><!-- #comment-## -->
	<li class="comment regularcomment" id="comment-25488">
		<div class="author">
			<div class="pic">
				<img alt='' src='http://0.gravatar.com/avatar/eb1a050181eb05dadee28813c6c7c48e?s=32&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D32&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />			</div>
			<div class="name">
									<span id="commentauthor-25488">
				
				Nobody
									</span>
							</div>
		</div>

		<div class="info">
			<div class="date">
				April 21st, 2014 at 11:09					 | <a href="#comment-25488">#3</a>
			</div>
			<div class="act">
				<a href="javascript:void(0);" onclick="MGJS_CMT.reply('commentauthor-25488', 'comment-25488', 'comment');">Reply</a> | 
				<a href="javascript:void(0);" onclick="MGJS_CMT.quote('commentauthor-25488', 'comment-25488', 'commentbody-25488', 'comment');">Quote</a>
							</div>
			<div class="fixed"></div>
			<div class="content">
				
				<div id="commentbody-25488">
					<p>余老师，麻烦请教个问题：<br />
Erlang支持Binary直接映射到record不？我尝试这样写过，报错，请指点，谢谢了：</p>
<p>    1 -module(record).<br />
    2 -export([birthday/1, joe/0, showPerson/1]).<br />
    3<br />
    4 -define (INT, 32/signed-big-integer).<br />
    5 -define (USHORT, 16/unsigned-big-integer).<br />
    6 -define (SHORT, 16/signed-big-integer).<br />
    7 -define (UBYTE, 8/unsigned-big-integer).<br />
    8 -define (BYTE, 8/signed-big-integer).<br />
    9 -define (BIN8, 8/binary).<br />
   10 -define (BIN21, 21/binary).<br />
   11 -define (BIN5, 5/binary).<br />
   12 -define (BIN10, 10/binary).<br />
   13 -define (BIN16, 16/binary).<br />
   14 -define (BIN6, 6/binary).<br />
   15 -define (BIN4, 4/binary).<br />
   16<br />
   17 -record(address, {post_addr, post_no}).  -record(person, {name,age=0,phone, address}).<br />
   18<br />
   19 birthday(#person{age=Age} = P) -&gt;<br />
   20     P#person{age=Age+1}.<br />
   21<br />
   22 joe() -&gt;<br />
   23     #person{name=&#8221;Joe&#8221;,<br />
   24             age=21,<br />
   25             phone=&#8221;999-999&#8243;,<br />
   26             address = #address<br />
   27             {post_addr=&#8221;postaddr&#8221;,<br />
   28              post_no=&#8221;post_no&#8221;}}.<br />
   29<br />
   30 showPerson(Person) -&gt;<br />
   31     io:format(&#8220;name: [~p] age: [~p] phone: [~p], postaddr:[~p], postno:[~p] ~n&#8221;,<br />
   32               [Person#person.name,<br />
   33                Person#person.age,<br />
   34                Person#person.phone,<br />
   35                Person#person.address#address.post_addr,<br />
   36                Person#person.address#address.post_no ]).<br />
   37<br />
   38 joe(BinaryData)-&gt;<br />
&gt;&gt; 39     &lt;&gt; = BinaryData,<br />
   44     P.<br />
   45  </p>
<p>新手问题，我实在是没找到这方面的资料，想过使用临时变量存储一下，再导入到record，但是总觉的这样不是太简洁，代码有点冗余！</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,25488,1,'Nobody');">Reply</a>]</p><div class="comment-childs chalt" id="comment-25686"><img alt='' src='http://0.gravatar.com/avatar/2f3b92251d56989e1fdbe07eb6299160?s=32&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D32&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' /><p><cite><a href='http://yufeng.info' rel='external nofollow' class='url'>Yu Feng</a></cite> Reply:<br /><small class="commentmetadata">April 22nd, 2014 at 8:22 pm</small></p><p>record实际上是个tuple，没有binary到tuple的转换，也没必要。</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,25686,2,'Yu Feng');">Reply</a>]</p></div>				</div>
			</div>
		</div>
		<div class="fixed"></div>

</li><!-- #comment-## -->
	<li class="comment regularcomment" id="comment-28517">
		<div class="author">
			<div class="pic">
				<img alt='' src='http://1.gravatar.com/avatar/98f5afe1961ae9ad5040e3918cda4d30?s=32&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D32&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' />			</div>
			<div class="name">
									<span id="commentauthor-28517">
				
				botanyzh
									</span>
							</div>
		</div>

		<div class="info">
			<div class="date">
				May 17th, 2014 at 02:47					 | <a href="#comment-28517">#4</a>
			</div>
			<div class="act">
				<a href="javascript:void(0);" onclick="MGJS_CMT.reply('commentauthor-28517', 'comment-28517', 'comment');">Reply</a> | 
				<a href="javascript:void(0);" onclick="MGJS_CMT.quote('commentauthor-28517', 'comment-28517', 'commentbody-28517', 'comment');">Quote</a>
							</div>
			<div class="fixed"></div>
			<div class="content">
				
				<div id="commentbody-28517">
					<p>余大  既然hipe改用 llvm 做后端了 是不是只要 llvm 能在windows 上 用  hipe就也能了呢</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,28517,1,'botanyzh');">Reply</a>]</p><div class="comment-childs chalt" id="comment-28663"><img alt='' src='http://0.gravatar.com/avatar/2f3b92251d56989e1fdbe07eb6299160?s=32&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D32&amp;r=G' class='avatar avatar-32 photo' height='32' width='32' /><p><cite><a href='http://yufeng.info' rel='external nofollow' class='url'>Yu Feng</a></cite> Reply:<br /><small class="commentmetadata">May 18th, 2014 at 9:03 pm</small></p><p>windows是二等公民，高性能就算了，别用windows.</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,28663,2,'Yu Feng');">Reply</a>]</p></div>				</div>
			</div>
		</div>
		<div class="fixed"></div>

</li><!-- #comment-## -->
	</ol>
	<!-- comments END -->


	<!-- trackbacks START -->
			<ol id="thetrackbacks">
							<li class="messagebox">
					No trackbacks yet.				</li>

					</ol>
		<div class="fixed"></div>
	<!-- trackbacks END -->
</div>

</div>

	<form action="http://blog.yufeng.info/wp-comments-post.php" method="post" id="commentform">
	<div id="respond">

					
			<div id="author_info">
				<div class="row">
					<input type="text" name="author" id="author" class="textfield" value="" size="24" tabindex="1" />
					<label for="author" class="small">Name (required)</label>
				</div>
				<div class="row">
					<input type="text" name="email" id="email" class="textfield" value="" size="24" tabindex="2" />
					<label for="email" class="small">E-Mail (will not be published) (required)</label>
				</div>
				<div class="row">
					<input type="text" name="url" id="url" class="textfield" value="" size="24" tabindex="3" />
					<label for="url" class="small">Website</label>
				</div>
			</div>

			
		
		<!-- comment input -->
		<div class="row">
			<textarea name="comment" id="comment" tabindex="4" rows="8" cols="50"></textarea>
		</div>

		<!-- comment submit and rss -->
		<div id="submitbox">
			<a class="feed" href="http://blog.yufeng.info/comments/feed">Subscribe to comments feed</a>
			<div class="submitbutton">
				<input name="submit" type="submit" id="submit" class="button" tabindex="5" value="Submit Comment" />
			</div>
						<input type="hidden" name="comment_post_ID" value="3104" />
			<div class="fixed"></div>
		</div>

	</div>
	<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="e36acd4174" /></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Notify me of follow-up comments by email.</label></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Notify me of new posts by email.</label></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="66"/></p><p><input type="hidden" id="comment_reply_ID" name="comment_reply_ID" value="0" /><input type="hidden" id="comment_reply_dp" name="comment_reply_dp" value="0" /></p><div id="cancel_reply" style="display:none;"><a href="javascript:void(0)" onclick="movecfm(null,0,1,null);" style="color:red;">Click to cancel reply</a></div><script type="text/javascript">
/* <![CDATA[ */
var commentformid = "commentform";
var USERINFO = false;
var atreply = "none";
/* ]]> */
</script>
<script type="text/javascript" src="http://blog.yufeng.info/wp-content/plugins/wordpress-thread-comment/wp-thread-comment.js.php?jsver=common"></script>
	</form>

			<script type="text/javascript">MGJS.loadCommentShortcut();</script>
	

	<div id="postnavi">
		<span class="prev"><a href="http://blog.yufeng.info/archives/3118" rel="next">Erlang内存分配器之mbcs_pool</a></span>
		<span class="next"><a href="http://blog.yufeng.info/archives/3098" rel="prev">Erlang 新数据类型Map的定位和性能</a></span>
		<div class="fixed"></div>
	</div>


	</div>
	<!-- main END -->

	
<!-- sidebar START -->
<div id="sidebar">

<!-- sidebar north START -->
<div id="northsidebar" class="sidebar">

	<!-- feeds -->
	<div class="widget widget_feeds">
		<div class="content">
			<div id="subscribe">
				<a rel="external nofollow" id="feedrss" title="Subscribe to this blog..." href="http://blog.yufeng.info/feed"><abbr title="Really Simple Syndication">RSS</abbr></a>
									<ul id="feed_readers">
						<li id="google_reader"><a rel="external nofollow" class="reader" title="Subscribe with Google" href="http://fusion.google.com/add?feedurl=http://blog.yufeng.info/feed"><span>Google</span></a></li>
						<li id="youdao_reader"><a rel="external nofollow" class="reader" title="Subscribe with Youdao" href="http://reader.youdao.com/#url=http://blog.yufeng.info/feed"><span>Youdao</span></a></li>
						<li id="xianguo_reader"><a rel="external nofollow" class="reader" title="Subscribe with Xian Guo" href="http://www.xianguo.com/subscribe.php?url=http://blog.yufeng.info/feed"><span>Xian Guo</span></a></li>
						<li id="zhuaxia_reader"><a rel="external nofollow" class="reader" title="Subscribe with Zhua Xia" href="http://www.zhuaxia.com/add_channel.php?url=http://blog.yufeng.info/feed"><span>Zhua Xia</span></a></li>
						<li id="yahoo_reader"><a rel="external nofollow" class="reader" title="Subscribe with My Yahoo!"	href="http://add.my.yahoo.com/rss?url=http://blog.yufeng.info/feed"><span>My Yahoo!</span></a></li>
						<li id="newsgator_reader"><a rel="external nofollow" class="reader" title="Subscribe with newsgator"	href="http://www.newsgator.com/ngs/subscriber/subfext.aspx?url=http://blog.yufeng.info/feed"><span>newsgator</span></a></li>
						<li id="bloglines_reader"><a rel="external nofollow" class="reader" title="Subscribe with Bloglines"	href="http://www.bloglines.com/sub/http://blog.yufeng.info/feed"><span>Bloglines</span></a></li>
						<li id="inezha_reader"><a rel="external nofollow" class="reader" title="Subscribe with iNezha"	href="http://inezha.com/add?url=http://blog.yufeng.info/feed"><span>iNezha</span></a></li>
					</ul>
							</div>
							<a id="followme" title="Follow me!" href="http://twitter.com/eric33yu/">Twitter</a>
						<div class="fixed"></div>
		</div>
	</div>

	<!-- showcase -->
	
<div id="paypal_donations-3" class="widget widget_paypal_donations"><h3>buy me a coffee.</h3><!-- Begin PayPal Donations by http://johansteen.se/ -->

<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
    <div class="paypal-donations">
        <input type="hidden" name="cmd" value="_donations" />
        <input type="hidden" name="business" value="mryufeng@gmail.com" />
        <input type="hidden" name="item_name" value="buy me a coffee." />
        <input type="hidden" name="item_number" value="yufeng" />
        <input type="hidden" name="amount" value="10" />
        <input type="hidden" name="currency_code" value="USD" />
        <input type="image" src="https://www.paypal.com/en_US/i/btn/btn_donate_LG.gif" name="submit" alt="PayPal - The safer, easier way to pay online." />
        <img alt="" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1" />
    </div>
</form>
<!-- End PayPal Donations -->
</div><div id="text-3" class="widget widget_text"><h3>广告时间</h3>			<div class="textwidget"><p>阿里核心系统数据库组招募高手！</p>
</div>
		</div><div id="text-4" class="widget widget_text"><h3>工作机会</h3>			<div class="textwidget"><p>招聘信息：<a href="http://blog.yufeng.info/job" onclick="_gaq.push(['_trackEvent', 'outbound-widget-int', 'http://blog.yufeng.info/job', '猛点这里获得工作机会']);" >猛点这里获得工作机会</a>  </p>
</div>
		</div>		<div id="recent-posts-3" class="widget widget_recent_entries">		<h3>Recent Posts</h3>		<ul>
					<li>
				<a href="http://blog.yufeng.info/archives/3149">R17新的调度策略+sub</a>
						</li>
					<li>
				<a href="http://blog.yufeng.info/archives/3133">Erlang内存体系调优</a>
						</li>
					<li>
				<a href="http://blog.yufeng.info/archives/3130">Erlang公平调度的误解</a>
						</li>
					<li>
				<a href="http://blog.yufeng.info/archives/3118">Erlang内存分配器之mbcs_pool</a>
						</li>
					<li>
				<a href="http://blog.yufeng.info/archives/3104">基于LLVM的高性能Erlang(Hipe)尝鲜</a>
						</li>
				</ul>
		</div><div id="recent-comments-3" class="widget widget_recent_comments"><h3>Recent Comments</h3><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a href='http://mcoder-003-site1.site4future.com/archives/9' rel='external nofollow' class='url'>TCP洪水攻击（SYN Flood）的诊断和处理 | 我的博客</a></span> on <a href="http://blog.yufeng.info/archives/1380/comment-page-1#comment-45198">老生常谈: ulimit问题及其影响</a></li><li class="recentcomments"><span class="comment-author-link"><a href='http://riccardotravels.wordpress.com/2014/04/23/cheap-holidays-with-h10-hotels-using-voucher-codes/' rel='external nofollow' class='url'>riccardotravels.wordpress.com</a></span> on <a href="http://blog.yufeng.info/archives/1768/comment-page-1#comment-44764">Flashcache使用的误区以及解决方案</a></li><li class="recentcomments"><span class="comment-author-link"><a href='http://yufeng.info' rel='external nofollow' class='url'>Yu Feng</a></span> on <a href="http://blog.yufeng.info/archives/1752/comment-page-1#comment-44520">Erlang如何限制节点对集群的访问之net_kernel:allow</a></li></ul></div></div>
<!-- sidebar north END -->

<div id="centersidebar">

	<!-- sidebar east START -->
	<div id="eastsidebar" class="sidebar">
	
		<!-- categories -->
		<div class="widget widget_categories">
			<h3>Categories</h3>
			<ul>
					<li class="cat-item cat-item-3"><a href="http://blog.yufeng.info/archives/category/erlang" title="探索erlang的方方面面">Erlang探索</a>
</li>
	<li class="cat-item cat-item-240"><a href="http://blog.yufeng.info/archives/category/linux_kb" >Linux</a>
</li>
	<li class="cat-item cat-item-481"><a href="http://blog.yufeng.info/archives/category/%e4%ba%86%e8%a7%a3%e7%b3%bb%e5%88%97" >了解系列</a>
</li>
	<li class="cat-item cat-item-480"><a href="http://blog.yufeng.info/archives/category/%e4%bd%93%e7%b3%bb%e7%bb%93%e6%9e%84" >体系结构</a>
</li>
	<li class="cat-item cat-item-152"><a href="http://blog.yufeng.info/archives/category/tools" >工具介绍</a>
</li>
	<li class="cat-item cat-item-374"><a href="http://blog.yufeng.info/archives/category/database" title="MySQL和其他KV数据库">数据库</a>
</li>
	<li class="cat-item cat-item-4"><a href="http://blog.yufeng.info/archives/category/misc" title="无法分类 乱七八糟的东西">杂七杂八</a>
</li>
	<li class="cat-item cat-item-290"><a href="http://blog.yufeng.info/archives/category/%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90" >源码分析</a>
</li>
	<li class="cat-item cat-item-46"><a href="http://blog.yufeng.info/archives/category/life" title="情感交流">生活</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://blog.yufeng.info/archives/category/network" title="网络编程和工具">网络编程</a>
</li>
	<li class="cat-item cat-item-311"><a href="http://blog.yufeng.info/archives/category/%e8%b0%83%e4%bc%98" >调优</a>
</li>
			</ul>
		</div>

		</div>
	<!-- sidebar east END -->

	<!-- sidebar west START -->
	<div id="westsidebar" class="sidebar">
	
		<!-- blogroll -->
		<div class="widget widget_links">
			<h3>Blogroll</h3>
			<ul>
				<li><a href="http://www.bookandman.com/?from=yufeng" target="_blank">book and man</a></li>
<li><a href="http://www.cnerlang.com">erlang中文社区</a></li>
<li><a href="http://dinglin.javaeye.com/?from=yufeng">MySQL专家丁奇</a></li>
<li><a href="http://logn.me" title="nessdb">一工(BohuTANG)博客</a></li>
<li><a href="http://blog.coly.li/?from=yufeng" title="文件系统专家" target="_blank">伯松的blog</a></li>
<li><a href="http://gaoyusong.com/?from=yufeng">剑川个人博客</a></li>
<li><a href="http://zhuzhaoyuan.com/?from=yufeng" target="_blank">叔度博客(nginx专家)</a></li>
<li><a href="http://www.imagerabit.com/?from=yufeng">小天后的图像处理博客</a></li>
<li><a href="http://www.qingliangcn.com/?from=yufeng" target="_blank">庆亮的博客</a></li>
<li><a href="http://www.osforce.cn/?from=yufeng" title="开源力量">开源力量</a></li>
<li><a href="http://www.penglixun.com/?from=yufeng">彭爷MySQL研究博客</a></li>
<li><a href="http://mryufeng.javaeye.com?from=yufeng" title="javaeye上的" target="_blank">我的旧非业余研究</a></li>
<li><a href="http://donghao.org/?from=yufeng" title="内核和文件系统">斯巴达第二季</a></li>
<li><a href="http://www.nosqlnotes.net/?from=yufeng">日照分布式存储</a></li>
<li><a href="http://blog.lifeibo.com/?from=yufeng">李子非主流程序员</a></li>
<li><a href="http://ybbct.iteye.com/?from=yufeng">武藏个人博客</a></li>
<li><a href="http://nil-zhang.iteye.com/?from=yufeng">淘宝千石的博客</a></li>
<li><a href="http://mysql.taobao.org" title="维护淘宝的MySQL分支">淘宝数据库组</a></li>
<li><a href="http://csrd.aliapp.com/?from=yufeng" title="基础 极致 分享" target="_blank">淘宝核心系统博客</a></li>
<li><a href="http://abloz.com?from=yufeng">瀚海星空</a></li>
<li><a href="http://www.cnblogs.com/lispking/">点滴随笔(MySQL和集群相关)</a></li>
<li><a href="http://hidba.org/?from=yufeng" title="玄惭MySQL运维博客">玄惭MySQL运维博客</a></li>
<li><a href="http://wqtn22.iteye.com/?from=yufeng">皓庭Erlang开发博客</a></li>
<li><a href="http://i.mtime.com/844165">祁奚个人博客</a></li>
<li><a href="http://www.wangchi.info/?from=yufeng" title="音乐 电子 composer" target="_blank">老婆的交互式音乐</a></li>
<li><a href="http://www.orczhou.com/">苏普的MySQL故事博客</a></li>
<li><a href="http://www.hoterran.info/?from=yufeng" title="Erlang开发">运维和开发-hoterran</a></li>
<li><a href="http://www.alibabatech.org/?from=yufeng">阿里巴巴技术协会</a></li>
<li><a href="http://www.pagefault.info/?from=yufeng">雕梁nginx和内核</a></li>
<li><a href="http://blog.csdn.net/wudongxu?from=yufeng">项仲个人博客</a></li>
			</ul>
		</div>

		</div>
	<!-- sidebar west END -->
	<div class="fixed"></div>
</div>

<!-- sidebar south START -->
<div id="southsidebar" class="sidebar">

	<!-- archives -->
	<div class="widget">
		<h3>Archives</h3>
					<ul>
					<li><a href='http://blog.yufeng.info/archives/date/2014/05'>May 2014</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2014/04'>April 2014</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2014/03'>March 2014</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2014/02'>February 2014</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2014/01'>January 2014</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2013/12'>December 2013</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2013/11'>November 2013</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2013/10'>October 2013</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2013/08'>August 2013</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2013/07'>July 2013</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2013/06'>June 2013</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2013/05'>May 2013</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2013/04'>April 2013</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2013/03'>March 2013</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2013/02'>February 2013</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2013/01'>January 2013</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2012/12'>December 2012</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2012/10'>October 2012</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2012/09'>September 2012</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2012/08'>August 2012</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2012/07'>July 2012</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2012/06'>June 2012</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2012/05'>May 2012</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2012/04'>April 2012</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2012/03'>March 2012</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2012/02'>February 2012</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2012/01'>January 2012</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2011/12'>December 2011</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2011/11'>November 2011</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2011/10'>October 2011</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2011/09'>September 2011</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2011/07'>July 2011</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2011/06'>June 2011</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2011/05'>May 2011</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2011/04'>April 2011</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2011/03'>March 2011</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2011/02'>February 2011</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2011/01'>January 2011</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2010/12'>December 2010</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2010/11'>November 2010</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2010/10'>October 2010</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2010/09'>September 2010</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2010/08'>August 2010</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2010/07'>July 2010</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2010/06'>June 2010</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2010/05'>May 2010</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2010/04'>April 2010</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2010/03'>March 2010</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2010/02'>February 2010</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2010/01'>January 2010</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2009/11'>November 2009</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2009/10'>October 2009</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2009/09'>September 2009</a></li>
	<li><a href='http://blog.yufeng.info/archives/date/2009/08'>August 2009</a></li>
			</ul>
			</div>

	<!-- meta -->
	<div class="widget">
		<h3>Meta</h3>
		<ul>
						<li><a href="http://blog.yufeng.info/wp-login.php">Log in</a></li>
		</ul>
	</div>

</div>
<!-- sidebar south END -->

</div>
<!-- sidebar END -->
	<div class="fixed"></div>
</div>
<!-- content END -->

<!-- footer START -->
<div id="footer">
	<a id="gotop" href="#" onclick="MGJS.goTop();return false;">Top</a>
	<a id="powered" href="http://wordpress.org/">WordPress</a>
	<div id="copyright">
		Copyright &copy; 2009-2014 系统技术非业余研究	</div>
	<div id="themeinfo">
		Theme by <a href="http://www.neoease.com/">NeoEase</a>. Valid <a href="http://validator.w3.org/check?uri=referer">XHTML 1.1</a> and <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3">CSS 3</a>.	</div>
</div>
<!-- footer END -->

</div>
<!-- container END -->
</div>
<!-- wrap END -->

	<div style="display:none">
	<div class="grofile-hash-map-42b722ed664104b1414eb89bf683ea76">
	</div>
	<div class="grofile-hash-map-2f3b92251d56989e1fdbe07eb6299160">
	</div>
	<div class="grofile-hash-map-c6ae6af885e39b67872494023dc970e8">
	</div>
	<div class="grofile-hash-map-eb1a050181eb05dadee28813c6c7c48e">
	</div>
	<div class="grofile-hash-map-98f5afe1961ae9ad5040e3918cda4d30">
	</div>
	</div>
<script type='text/javascript' src='http://blog.yufeng.info/wp-content/plugins/akismet/_inc/form.js?ver=3.0.2'></script>
<script type='text/javascript' src='http://blog.yufeng.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/shCore.js?ver=2.1.364'></script>
<script type='text/javascript' src='http://blog.yufeng.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/shBrushBash.js?ver=2.1.364'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://blog.yufeng.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/styles/shCore.css?ver=2.1.364";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://blog.yufeng.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/styles/shThemeDefault.css?ver=2.1.364";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.clipboardSwf = 'http://blog.yufeng.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf';
	SyntaxHighlighter.config.strings.expandSource = 'show source';
	SyntaxHighlighter.config.strings.viewSource = 'view source';
	SyntaxHighlighter.config.strings.copyToClipboard = 'copy to clipboard';
	SyntaxHighlighter.config.strings.copyToClipboardConfirmation = 'The code is in your clipboard now';
	SyntaxHighlighter.config.strings.print = 'print';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
	SyntaxHighlighter.defaults['pad-line-numbers'] = true;
	SyntaxHighlighter.defaults['smart-tabs'] = false;
	SyntaxHighlighter.all();
</script>
<link rel='stylesheet' id='yarppRelatedCss-css'  href='http://blog.yufeng.info/wp-content/plugins/yet-another-related-posts-plugin/style/related.css?ver=4.0' type='text/css' media='all' />
<script type='text/javascript' src='http://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201444'></script>
<script type='text/javascript' src='http://s.gravatar.com/js/gprofiles.js?ver=2014Octaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='http://blog.yufeng.info/wp-content/plugins/jetpack/modules/wpgroho.js?ver=4.0'></script>

	<script src="http://stats.wp.com/e-201444.js" type="text/javascript"></script>
	<script type="text/javascript">
	st_go({v:'ext',j:'1:3.1.1',blog:'21500275',post:'3104',tz:'8'});
	var load_cmc = function(){linktracker_init(21500275,3104,2);};
	if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
	else load_cmc();
	</script>
</body>
</html>

